<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mini Golf Valentine ‚õ≥Ô∏è</title>
  <style>
    .musicBtn{
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.04);
  color: var(--text);
  padding: 8px 12px;
  border-radius: 999px;
  font-weight: 750;
  cursor: pointer;
  transition: transform .08s ease, background .2s ease, border-color .2s ease;
  font-size: 13px;
  white-space: nowrap;
}

.musicBtn:hover{
  transform: translateY(-1px);
  border-color: rgba(255, 105, 180, .55);
  background: rgba(255, 105, 180, .10);
}
    :root{
      --bg: #0b2a17;
      --card: #0f3a21;
      --line: rgba(255,255,255,.12);
      --text: #f4fff7;
      --muted: rgba(244,255,247,.75);
      --accent: #7CFFB2;
      --accent2: #ffd6e7;
      --hole: #07150d;
      --ball: #ffffff;
      --flag: #ff4d6d;
    }

    *{ box-sizing: border-box; }

    body{
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(800px 500px at 20% 10%, rgba(124,255,178,.18), transparent 60%),
        radial-gradient(700px 500px at 80% 90%, rgba(255,214,231,.14), transparent 60%),
        linear-gradient(180deg, var(--bg), #06160d);
      color: var(--text);
      padding: 24px;
      overflow-x: hidden;
    }

    /* Floating hearts layer */
    .hearts{
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 0;
    }

    .heart{
      position: absolute;
      bottom: -40px;
      left: var(--x);
      width: var(--size);
      height: var(--size);
      opacity: var(--opacity);
      transform: translateY(0) rotate(var(--rot));
      animation: floatUp var(--dur) linear infinite;
    }

    .heart::before{
      content: "‚ù§";
      display: grid;
      place-items: center;
      width: 100%;
      height: 100%;
      font-size: calc(var(--size) * 1.05);
      color: rgba(255, 105, 180, 5);
      text-shadow: 0 8px 24px rgba(0,0,0,.35);
    }

    @keyframes floatUp{
      0%{
        transform: translateY(0) translateX(0) rotate(var(--rot));
        opacity: 0;
      }
      10%{ opacity: var(--opacity); }
      100%{
        transform: translateY(-120vh) translateX(var(--drift)) rotate(calc(var(--rot) + 40deg));
        opacity: 0;
      }
    }

    .wrap{
      width: min(560px, 100%);
      position: relative;
      z-index: 2;
    }

    .top{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 14px;
    }

    .badge{
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border: 1px solid var(--line);
      border-radius: 999px;
      color: var(--muted);
      font-size: 13px;
      background: rgba(255,255,255,.03);
      backdrop-filter: blur(6px);
    }

    .title{
      font-size: 22px;
      font-weight: 750;
      letter-spacing: .2px;
      margin: 0;
    }

    .card{
      background: rgba(15,58,33,.75);
      border: 1px solid var(--line);
      border-radius: 18px;
      padding: 18px;
      box-shadow: 0 18px 50px rgba(0,0,0,.35);
      position: relative;
      overflow: hidden;
    }

    .card::before{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(500px 250px at 30% 0%, rgba(124,255,178,.18), transparent 55%);
      pointer-events:none;
    }

    .scoreHeader{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      margin-bottom: 14px;
      position: relative;
    }

    .scoreHeader h2{
      margin:0;
      font-size: 18px;
      font-weight: 750;
    }

    .names{
      color: var(--muted);
      margin-top: 4px;
      font-size: 13px;
    }

    .pill{
      border: 1px solid var(--line);
      border-radius: 999px;
      padding: 8px 10px;
      font-size: 12px;
      color: var(--muted);
      background: rgba(255,255,255,.03);
      white-space: nowrap;
    }

    table{
      width:100%;
      border-collapse: collapse;
      overflow: hidden;
      border-radius: 14px;
      border: 1px solid var(--line);
      position: relative;
    }

    th, td{
      padding: 12px 10px;
      border-bottom: 1px solid var(--line);
      font-size: 14px;
    }

    th{
      text-align: left;
      color: var(--muted);
      font-weight: 650;
      background: rgba(255,255,255,.03);
    }

    tr:last-child td{
      border-bottom: none;
    }

    .score{
      text-align: right;
      font-weight: 800;
      letter-spacing: .2px;
    }

    .final{
      margin-top: 14px;
      padding: 14px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      position: relative;
    }

    .final .label{
      color: var(--muted);
      font-size: 12px;
      margin-bottom: 6px;
    }

    .final .big{
      font-size: 18px;
      font-weight: 850;
    }

    .ask{
      margin-top: 14px;
      display: grid;
      gap: 10px;
      position: relative;
    }

    .ask p{
      margin: 0;
      color: var(--muted);
      font-size: 13px;
    }

    .ask h3{
      margin: 0;
      font-size: 20px;
      font-weight: 900;
      letter-spacing: .2px;
    }

    .btns{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 6px;
    }

    button{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 750;
      cursor: pointer;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
      font-size: 14px;
    }

    button:hover{
      transform: translateY(-1px);
      border-color: rgba(124,255,178,.45);
      background: rgba(124,255,178,.08);
    }

    .no{
      border-color: rgba(255, 105, 180, .25);
      background: rgba(255, 105, 180, .06);
    }

    .no:hover{
      border-color: rgba(255, 105, 180, .55);
      background: rgba(255, 105, 180, .10);
    }

    .yes{
      border-color: rgba(124,255,178,.35);
      background: rgba(124,255,178,.10);
    }

    .yes:hover{
      border-color: rgba(124,255,178,.65);
      background: rgba(124,255,178,.16);
    }

    .footerNote{
      margin-top: 12px;
      color: rgba(244,255,247,.55);
      font-size: 12px;
      text-align: center;
    }

    /* Mini golf hole-in-one animation */
    .miniGolf{
      margin-top: 14px;
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 14px;
      background: rgba(255,255,255,.03);
      position: relative;
      overflow: hidden;
    }

    .miniTop{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 10px;
    }

    .miniTop .left{
      display:grid;
      gap: 2px;
    }

    .miniTop .label{
      font-size: 12px;
      color: var(--muted);
    }

    .miniTop .name{
      font-weight: 850;
      font-size: 14px;
    }

    .fairway{
      position: relative;
      height: 86px;
      border-radius: 14px;
      background:
        linear-gradient(180deg, rgba(124,255,178,.18), rgba(124,255,178,.05)),
        radial-gradient(200px 120px at 70% 50%, rgba(255,255,255,.05), transparent 60%),
        rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
      overflow: hidden;
    }

    .confetti{
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      opacity: 0;
    }

    .shooting .confetti{
      animation: confettiFade 1.15s ease forwards;
    }

    @keyframes confettiFade{
      0%{ opacity: 0; }
      70%{ opacity: 0; }
      100%{ opacity: 1; }
    }

    .laneLine{
      position:absolute;
      left: 12px;
      right: 12px;
      top: 50%;
      height: 1px;
      background: rgba(255,255,255,.10);
      transform: translateY(-50%);
    }

    .hole{
      position: absolute;
      right: 18px;
      top: 50%;
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.08), rgba(0,0,0,.55));
      border: 1px solid rgba(0,0,0,.35);
      transform: translateY(-50%);
      box-shadow: inset 0 6px 10px rgba(0,0,0,.55);
    }

    .flag{
      position: absolute;
      right: 34px;
      top: 12px;
      width: 2px;
      height: 44px;
      background: rgba(255,255,255,.35);
      border-radius: 2px;
      opacity: .9;
    }

    .flag::after{
      content: "";
      position: absolute;
      left: 2px;
      top: 6px;
      width: 18px;
      height: 12px;
      background: var(--flag);
      border-radius: 3px;
      box-shadow: 0 8px 18px rgba(0,0,0,.25);
      transform-origin: left center;
      animation: wave 1.6s ease-in-out infinite;
    }

    @keyframes wave{
      0%, 100%{ transform: rotate(0deg) skewX(0deg); }
      50%{ transform: rotate(-6deg) skewX(-8deg); }
    }

    .ball{
      position: absolute;
      left: 18px;
      top: 50%;
      width: 16px;
      height: 16px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.55));
      transform: translateY(-50%);
      box-shadow: 0 10px 20px rgba(0,0,0,.35);
    }

    .ballShadow{
      position:absolute;
      left: 18px;
      top: calc(50% + 12px);
      width: 18px;
      height: 6px;
      border-radius: 999px;
      background: rgba(0,0,0,.35);
      filter: blur(2px);
      transform: translateY(-50%);
      opacity: .55;
    }

    .shooting .ball{
      animation: rollIn 1.15s cubic-bezier(.22,.9,.25,1) forwards;
    }

    .shooting .ballShadow{
      animation: shadowMove 1.15s cubic-bezier(.22,.9,.25,1) forwards;
    }

    @keyframes rollIn{
      0%{ left: 18px; transform: translateY(-50%) scale(1); }
      70%{ left: calc(100% - 64px); transform: translateY(-50%) scale(.98); }
      100%{ left: calc(100% - 28px); transform: translateY(-50%) scale(.6); opacity: 0; }
    }

    @keyframes shadowMove{
      0%{ left: 18px; opacity: .55; }
      70%{ left: calc(100% - 64px); opacity: .35; }
      100%{ left: calc(100% - 28px); opacity: 0; }
    }

    .sparkles{
      position:absolute;
      inset: 0;
      pointer-events:none;
      opacity: 0;
    }

    .shooting .sparkles{
      animation: pop 1.15s ease forwards;
    }

    @keyframes pop{
      0%{ opacity: 0; transform: scale(.98); }
      65%{ opacity: 0; }
      100%{ opacity: 1; transform: scale(1); }
    }

    .sparkle{
      position:absolute;
      right: 12px;
      top: 50%;
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: rgba(124,255,178,.95);
      box-shadow:
        0 0 0 6px rgba(124,255,178,.18),
        0 0 24px rgba(124,255,178,.45);
      transform: translateY(-50%);
    }

    .sparkle.s2{ right: 26px; top: 40%; opacity: .9; }
    .sparkle.s3{ right: 28px; top: 62%; opacity: .85; }

    .miniMsg{
      margin-top: 10px;
      color: var(--muted);
      font-size: 13px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
    }

    .tinyBtn{
      padding: 8px 10px;
      border-radius: 12px;
      font-size: 13px;
    }

    /* Modal */
    .modal{
      position: fixed;
      inset: 0;
      display: none;
      place-items: center;
      background: rgba(0,0,0,.55);
      padding: 18px;
      z-index: 5;
    }

    .modalBox{
      width: min(520px, 100%);
      background: rgba(15,58,33,.92);
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 18px;
      padding: 18px;
      box-shadow: 0 18px 60px rgba(0,0,0,.5);
    }

    .modalBox h4{
      margin: 0 0 6px;
      font-size: 20px;
      font-weight: 900;
    }

    .modalBox p{
      margin: 0 0 14px;
      color: var(--muted);
      line-height: 1.35;
    }

    .tiny{
      color: rgba(244,255,247,.6);
      font-size: 12px;
      margin-top: 10px;
    }

    .close{
      margin-top: 6px;
      width: 100%;
    }

    @media (prefers-reduced-motion: reduce){
      .heart{ animation: none; display:none; }
      .shooting .ball, .shooting .ballShadow{ animation: none; }
      .flag::after{ animation: none; }
    }

    /* Mobile tweaks */
    @media (max-width: 420px){
      body{ padding: 16px; }
      .title{ font-size: 20px; }
      .badge{ font-size: 12px; padding: 7px 10px; }
      th, td{ padding: 10px 8px; font-size: 13px; }
      .ask h3{ font-size: 18px; }
      .btns{ gap: 8px; }
      button{ width: 100%; }
      .miniTop{ flex-direction: column; align-items: stretch; }
      .tinyBtn{ width: 100%; }
    }
      .shooting .ball, .shooting .ballShadow{ animation: none; }
      .flag::after{ animation: none; }
  </style>
</head>
<body>
  <audio id="bgMusic" loop preload="auto">
  <source src="music.mp3" type="audio/mpeg" />
</audio>
<audio id="sfxYay" preload="auto">
  <source src="yay.mp3" type="audio/mpeg" />
</audio>
<audio id="sfxAww" preload="auto">
  <source src="aww.mp3" type="audio/mpeg" />
</audio>
<canvas id="confettiFull" aria-hidden="true"
  style="
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 9999;
  ">
</canvas>

  <!-- Floating hearts background -->
  <div class="hearts" aria-hidden="true">
    <span class="heart" style="--x: 8%; --size: 18px; --opacity:.35; --dur: 12s; --drift: 12px; --rot: -12deg;"></span>
    <span class="heart" style="--x: 18%; --size: 26px; --opacity:.28; --dur: 16s; --drift: -18px; --rot: 8deg;"></span>
    <span class="heart" style="--x: 28%; --size: 20px; --opacity:.30; --dur: 14s; --drift: 22px; --rot: -4deg;"></span>
    <span class="heart" style="--x: 40%; --size: 34px; --opacity:.20; --dur: 18s; --drift: -24px; --rot: 14deg;"></span>
    <span class="heart" style="--x: 55%; --size: 22px; --opacity:.26; --dur: 13s; --drift: 16px; --rot: -10deg;"></span>
    <span class="heart" style="--x: 66%; --size: 16px; --opacity:.34; --dur: 11s; --drift: -10px; --rot: 6deg;"></span>
    <span class="heart" style="--x: 76%; --size: 28px; --opacity:.22; --dur: 17s; --drift: 18px; --rot: -8deg;"></span>
    <span class="heart" style="--x: 88%; --size: 20px; --opacity:.30; --dur: 15s; --drift: -16px; --rot: 10deg;"></span>
    <span class="heart" style="--x: 94%; --size: 14px; --opacity:.36; --dur: 10s; --drift: 10px; --rot: -6deg;"></span>
    <span class="heart" style="--x: 5%; --size: 22px; --opacity:.60; --dur: 13s; --drift: 14px; --rot: -10deg;"></span>
    <span class="heart" style="--x: 12%; --size: 16px; --opacity:.70; --dur: 11s; --drift: -10px; --rot: 6deg;"></span>
    <span class="heart" style="--x: 24%; --size: 30px; --opacity:.50; --dur: 18s; --drift: 20px; --rot: 12deg;"></span>
    <span class="heart" style="--x: 33%; --size: 18px; --opacity:.68; --dur: 12s; --drift: -14px; --rot: -8deg;"></span>
    <span class="heart" style="--x: 46%; --size: 26px; --opacity:.56; --dur: 16s; --drift: 18px; --rot: 10deg;"></span>
    <span class="heart" style="--x: 58%; --size: 20px; --opacity:.62; --dur: 14s; --drift: -16px; --rot: -6deg;"></span>
    <span class="heart" style="--x: 63%; --size: 34px; --opacity:.45; --dur: 19s; --drift: 22px; --rot: 14deg;"></span>
    <span class="heart" style="--x: 71%; --size: 16px; --opacity:.72; --dur: 10s; --drift: -12px; --rot: 8deg;"></span>
    <span class="heart" style="--x: 83%; --size: 28px; --opacity:.52; --dur: 17s; --drift: 16px; --rot: -10deg;"></span>
    <span class="heart" style="--x: 92%; --size: 18px; --opacity:.66; --dur: 15s; --drift: -18px; --rot: 10deg;"></span>
  </div>

  <div class="wrap">
    <div class="top">
      <div class="badge">‚õ≥ Mini Golf Scorecard</div>

        <button class="musicBtn" id="musicBtn" onclick="toggleMusic()">
    Play music üé∂
  </button>

      <div class="badge">‚ù§Ô∏è Valentine‚Äôs Edition</div>
    </div>

    <h1 class="title"><span id="personName">Abby</span>‚Äôs Scorecard</h1>


    <div class="card">
      <div class="scoreHeader">
        <div>
          <h2><span id="personName2">Abby</span> vs Ugo</h2>
          <div class="names">Course: ‚ÄúA Night To Remember üíö‚Äù</div>
        </div>
        <div class="pill">Final hole: Feb 14 üòâ</div>
      </div>

      <table>
        <thead>
          <tr>
            <th>Hole</th>
            <th>What I‚Äôm scoring</th>
            <th class="score">Score</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>Your smile</td>
            <td class="score">10/10</td>
          </tr>
          <tr>
            <td>2</td>
            <td>Your Presence</td>
            <td class="score">50/10</td>
          </tr>
          <tr>
            <td>3</td>
            <td>You</td>
            <td class="score">100/10</td>
          </tr>
          <tr>
            <td>4</td>
            <td>Mini golf date</td>
            <td class="score">Pending‚Ä¶</td>
          </tr>
          <tr>
            <td>5</td>
            <td>Food after</td>
            <td class="score">Required üòå</td>
          </tr>
        </tbody>
      </table>

      <div class="final">
        <div class="label">Final Score</div>
        <div class="big">Me + You = Perfect Match</div>
      </div>

      <!-- Hole-in-one mini animation -->
      <div class="miniGolf">
        <div class="miniTop">
          <div class="left">
            <div class="label">Mini Golf Moment</div>
            <div class="name">Hole-in-one attempt üò≠</div>
          </div>
          <button class="tinyBtn" id="shootBtn" onclick="shootBall()">Take the shot ‚õ≥Ô∏è</button>
        </div>

        <div class="fairway" id="fairway">
          <canvas id="confetti" class="confetti" aria-hidden="true"></canvas>
          <div class="laneLine"></div>
          <div class="flag"></div>
          <div class="hole" aria-hidden="true"></div>

          <div class="ballShadow" id="ballShadow"></div>
          <div class="ball" id="ball"></div>

          <div class="sparkles" id="sparkles" aria-hidden="true">
            <div class="sparkle"></div>
            <div class="sparkle s2"></div>
            <div class="sparkle s3"></div>
          </div>
        </div>

        <div class="miniMsg">
          <span id="miniMsgText">If it goes in‚Ä¶ you have to say yes üòå</span>
          <span id="miniStatus" style="font-weight:800; color: rgba(124,255,178,.95);">READY</span>
        </div>
      </div>

      <div class="ask">
        <p>Okay‚Ä¶ serious question</p>
        <h3><span id="personName3">Abby</span>, Will you be my Valentine?‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</h3>
        <div class="btns">
          <button class="yes" onclick="celebrateYes()">Yes üòå</button>
          <button onclick="celebrateYes()">Of course! ü•π</button>
          <button onclick="reactAww()">Hmmm Let me think‚Ä¶ </button>
          <button class="no" id="noBtn">No üòÖ</button>
        </div>
      </div>

      <div class="footerNote">Winner picks the food after üòâ</div>
    </div>
  </div>

  <div class="modal" id="modal">
    <div class="modalBox" id="modalBox">
      <h4 id="modalTitle">LETS GOOO ‚õ≥Ô∏è‚ù§Ô∏è</h4>
      <p id="modalText">
        Okay cool‚Ä¶ so it‚Äôs official üòå<br/>
        I‚Äôm taking you mini golfing and we‚Äôre getting food after.
      </p>
      <button class="close" onclick="closeModal()">Close</button>
      <div class="tiny">Screenshot this and send it back to me üò≠</div>
    </div>
  </div>

  <script>
    const modal = document.getElementById("modal");
    const modalTitle = document.getElementById("modalTitle");
    const modalText = document.getElementById("modalText");

    const fairway = document.getElementById("fairway");
    const confettiCanvas = document.getElementById("confetti");
    const ctx = confettiCanvas.getContext("2d");
    const shootBtn = document.getElementById("shootBtn");
    const miniMsgText = document.getElementById("miniMsgText");
    const miniStatus = document.getElementById("miniStatus");
    const bgMusic = document.getElementById("bgMusic");
const musicBtn = document.getElementById("musicBtn");
const sfxYay = document.getElementById("sfxYay");
const sfxAww = document.getElementById("sfxAww");
const confettiFull = document.getElementById("confettiFull");
const ctxFull = confettiFull.getContext("2d");
// --- Dynamic name from URL ---
const params = new URLSearchParams(window.location.search);
const nameFromUrl = params.get("name");

if (nameFromUrl) {
  const safeName = nameFromUrl.trim();

  const n1 = document.getElementById("personName");
  const n2 = document.getElementById("personName2");
  const n3 = document.getElementById("personName3");

  if (n1) n1.textContent = safeName;
  if (n2) n2.textContent = safeName;
  if (n3) n3.textContent = safeName;
}

let musicOn = false;
function playSfx(audioEl, volume = 0.8){
  if(!audioEl) return;
  audioEl.pause();
  audioEl.currentTime = 0;
  audioEl.volume = volume;
  audioEl.play().catch(()=>{});
}

function resizeFullConfetti(){
  const dpr = window.devicePixelRatio || 1;
  confettiFull.width = Math.floor(window.innerWidth * dpr);
  confettiFull.height = Math.floor(window.innerHeight * dpr);
  ctxFull.setTransform(dpr, 0, 0, dpr, 0, 0);
}

window.addEventListener("resize", resizeFullConfetti);
setTimeout(resizeFullConfetti, 0);

function burstFullConfetti(){
  resizeFullConfetti();

  const w = window.innerWidth;
  const h = window.innerHeight;

  const pieces = 1000;
  const parts = [];

  for(let i=0;i<pieces;i++){
    parts.push({
      x: Math.random() * w,
      y: -10,
      vx: (Math.random() * 2 - 1) * 1.4,
      vy: Math.random() * 2 + 2.2,
      size: Math.random() * 5 + 3,
      life: Math.random() * 55 + 55,
      rot: Math.random() * Math.PI,
      vr: (Math.random() * 0.25 - 0.12)
    });
  }

  let frame = 0;

  function draw(){
    frame++;
    ctxFull.clearRect(0,0,w,h);

    for(const p of parts){
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.03;
      p.rot += p.vr;
      p.life -= 1;

      ctxFull.save();
      ctxFull.translate(p.x, p.y);
      ctxFull.rotate(p.rot);
      ctxFull.globalAlpha = Math.max(0, Math.min(1, p.life/110));
      ctxFull.fillStyle = `hsl(${Math.floor(Math.random()*360)}, 90%, 70%)`;
      ctxFull.fillRect(-p.size/2, -p.size/2, p.size, p.size);
      ctxFull.restore();
    }

    if(frame < 5000){
      requestAnimationFrame(draw);
    } else {
      ctxFull.clearRect(0,0,w,h);
    }
  }

  draw();
}

function celebrateYes(){
  playSfx(sfxYay, 0.85);
  burstFullConfetti();
  showWin();
}

function reactAww(){
  playSfx(sfxAww, 0.75);
  showTease();
}


function toggleMusic(){
  if(!bgMusic) return;

  if(!musicOn){
    bgMusic.volume = 0.25; // you can change this
    bgMusic.play().then(() => {
      musicOn = true;
      if(musicBtn) musicBtn.textContent = "Pause music üîá";
    }).catch(() => {
      // iPhone sometimes needs a second tap
      alert("Tap again to play üé∂");
    });
  } else {
    bgMusic.pause();
    musicOn = false;
    if(musicBtn) musicBtn.textContent = "Play music üé∂";
  }
}


    let isShooting = false;

    // No button runs away üò≠
    const noBtn = document.getElementById("noBtn");
    let noMoves = 0;

    function moveNoButton(){
      if(!noBtn) return;
      const maxMoves = 8;
      noMoves++;

      const pad = 10;
      const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
      const vh = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);

      // Keep it inside the viewport
      const x = Math.random() * (vw - noBtn.offsetWidth - pad*2) + pad;
      const y = Math.random() * (vh - noBtn.offsetHeight - pad*2) + pad;

      noBtn.style.position = "fixed";
      noBtn.style.left = x + "px";
      noBtn.style.top = y + "px";
      noBtn.style.zIndex = "6";

      if(noMoves >= maxMoves){
        noBtn.textContent = "Okay fine üò≠";
      }
    }

    if(noBtn){
      noBtn.addEventListener("mouseenter", moveNoButton);
      noBtn.addEventListener("touchstart", (e) => {
        e.preventDefault();
        moveNoButton();
      }, { passive: false });
      noBtn.addEventListener("click", (e) => {
        e.preventDefault();
        moveNoButton();
      });
    }

    function resizeConfetti(){
      const rect = confettiCanvas.getBoundingClientRect();
      const dpr = window.devicePixelRatio || 1;
      confettiCanvas.width = Math.floor(rect.width * dpr);
      confettiCanvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }

    window.addEventListener("resize", resizeConfetti);
    setTimeout(resizeConfetti, 0);

    function burstConfetti(){
      resizeConfetti();
      const w = confettiCanvas.getBoundingClientRect().width;
      const h = confettiCanvas.getBoundingClientRect().height;

      const pieces = 60;
      const parts = [];

      for(let i=0;i<pieces;i++){
        parts.push({
          x: w - 40,
          y: h/2,
          vx: (Math.random()*2 + 1) * -1,
          vy: (Math.random()*2 - 1),
          size: Math.random()*3 + 2,
          life: Math.random()*20 + 20,
          rot: Math.random()*Math.PI,
          vr: (Math.random()*0.2 - 0.1)
        });
      }

      let frame = 0;
      function draw(){
        frame++;
        ctx.clearRect(0,0,w,h);

        for(const p of parts){
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.03;
          p.rot += p.vr;
          p.life -= 1;

          // random bright colors (no hardcoding theme)
          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.globalAlpha = Math.max(0, Math.min(1, p.life/40));
          ctx.fillStyle = `hsl(${Math.floor(Math.random()*360)}, 90%, 70%)`;
          ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
          ctx.restore();
        }

        if(frame < 55){
          requestAnimationFrame(draw);
        } else {
          ctx.clearRect(0,0,w,h);
        }
      }

      draw();
    }

    function showWin(){
      modalTitle.textContent = "LETS GOOO ‚õ≥Ô∏è‚ù§Ô∏è";
      modalText.innerHTML =
        "Okay cool‚Ä¶ so it‚Äôs official üòå<br/>" +
        "I‚Äôm taking you mini golfing and we‚Äôre getting food after.";
      modal.style.display = "grid";
    }

    function showTease(){
      modalTitle.textContent = "Bet bet...";
      modalText.innerHTML =
        "Take your time<br/>" +
        "But I‚Äôm still keeping the mini golf date on the schedule.";
      modal.style.display = "grid";
    }

    function closeModal(){
      modal.style.display = "none";
    }

    modal.addEventListener("click", (e) => {
      if(e.target === modal) closeModal();
    });

    function shootBall(){
      if(isShooting) return;
      isShooting = true;

      miniStatus.textContent = "SHOT";
      miniMsgText.textContent = "Okay‚Ä¶ that one is going IN üò≠";
      shootBtn.disabled = true;
      shootBtn.style.opacity = "0.65";
      shootBtn.style.cursor = "not-allowed";

      fairway.classList.remove("shooting");
      void fairway.offsetWidth; // restart animation
      fairway.classList.add("shooting");

      // When the animation ends, show the result
      setTimeout(() => {
        miniStatus.textContent = "HOLE-IN-ONE";
        burstConfetti();
        miniMsgText.textContent = "Yup‚Ä¶ hole-in-one üòå now say yes.";
        showWin();

        // reset for replay (optional)
        setTimeout(() => {
          fairway.classList.remove("shooting");
          shootBtn.disabled = false;
          shootBtn.style.opacity = "1";
          shootBtn.style.cursor = "pointer";
          miniStatus.textContent = "READY";
          miniMsgText.textContent = "If it goes in‚Ä¶ you have to say yes üòå";
          isShooting = false;
        }, 1200);
      }, 1150);
    }
  </script>
</body>
</html>
